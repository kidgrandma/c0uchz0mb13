<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INTERNET OLYMPICS 2 ‚Ä¢ admin board</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <!-- Firebase Auth Login Window -->
    <div class="window login-window" id="loginWindow">
        <div class="window-header">
            <span>üîê System Authentication</span>
            <button class="window-close" disabled>√ó</button>
        </div>
        <div class="window-body">
            <div class="login-icon">üéÆ</div>
            <div class="login-title">INTERNET OLYMPICS 2</div>
            <div class="login-subtitle">admin access required</div>
            
            <div class="auth-container">
                <!-- Email/Password Login -->
                <div id="emailAuthSection">
                    <input type="email" 
                           id="adminEmail" 
                           class="text-input" 
                           placeholder="email address"
                           autocomplete="email">
                    <input type="password" 
                           id="adminPassword" 
                           class="text-input" 
                           placeholder="password"
                           autocomplete="current-password">
                    <button class="button primary" onclick="adminLogin()">authenticate ‚Üí</button>
                    
                    <div class="auth-divider">
                        <span>or</span>
                    </div>
                    
                    <button class="button google-auth" onclick="googleLogin()">
                        <span class="google-icon">üî∑</span> Sign in with Google
                    </button>
                </div>
                
                <!-- Loading State -->
                <div id="authLoading" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>authenticating...</p>
                </div>
            </div>
            
            <div class="error-message" id="loginError"></div>
            <div class="auth-footer">
                <small>authorized personnel only ‚Ä¢ firebase secured</small>
            </div>
        </div>
    </div>

    <!-- Main Admin Panel -->
    <div class="admin-container" id="adminPanel" style="display: none;">
        <!-- Desktop -->
        <div class="desktop">
            <!-- Header Bar -->
            <div class="taskbar">
                <div class="start-button">
                    <span>üéÆ INTERNET OLYMPICS 2</span>
                </div>
                <div class="taskbar-info">
                    <span class="user-display" id="currentUser"></span>
                    <span class="taskbar-clock" id="clock"></span>
                </div>
                <button class="logout-button" onclick="adminLogout()">sign out ‚Üí</button>
            </div>

            <!-- Desktop Icons Grid -->
            <div class="desktop-icons">
                <div class="desktop-icon" onclick="openWindow('dashboard')">
                    <div class="icon">üìä</div>
                    <div class="label">Dashboard</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('users')">
                    <div class="icon">üê∞</div>
                    <div class="label">Players</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('characters')">
                    <div class="icon">üíø</div>
                    <div class="label">Characters</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('tools')">
                    <div class="icon">üî™</div>
                    <div class="label">Tools</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('points')">
                    <div class="icon">üé±</div>
                    <div class="label">Points</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('money')">
                    <div class="icon">üíä</div>
                    <div class="label">Credits</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('teams')">
                    <div class="icon">ü¶ì</div>
                    <div class="label">Teams</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('pending')">
                    <div class="icon">‚ö†Ô∏è</div>
                    <div class="label">Pending</div>
                    <span class="notification-badge" id="pendingBadge" style="display: none;">0</span>
                </div>
            </div>

            <!-- Windows Container -->
            <div class="windows-container" id="windowsContainer">
                <!-- Dashboard Window -->
                <div class="window draggable" id="window-dashboard" style="display: none;">
                    <div class="window-header">
                        <span>üìä Dashboard</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('dashboard')">_</button>
                            <button class="maximize" onclick="maximizeWindow('dashboard')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('dashboard')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="dashboard-header">
                            <h2>Game Overview</h2>
                            <button class="button small" onclick="refreshDashboard()">üîÑ refresh</button>
                        </div>
                        <div class="stats-grid" id="statsGrid">
                            <div class="stat-card">
                                <div class="stat-icon">üë•</div>
                                <div class="stat-number" id="totalUsers">0</div>
                                <div class="stat-label">total players</div>
                            </div>
                            <div class="stat-card active">
                                <div class="stat-icon">‚úÖ</div>
                                <div class="stat-number" id="activeUsers">0</div>
                                <div class="stat-label">active</div>
                            </div>
                            <div class="stat-card revenue">
                                <div class="stat-icon">üí∞</div>
                                <div class="stat-number" id="totalRevenue">0</div>
                                <div class="stat-label">collected</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">üíä</div>
                                <div class="stat-number" id="totalCredit">0</div>
                                <div class="stat-label">credits available</div>
                            </div>
                            <div class="stat-card pending">
                                <div class="stat-icon">‚è≥</div>
                                <div class="stat-number" id="totalPending">0</div>
                                <div class="stat-label">pending</div>
                            </div>
                            <div class="stat-card points">
                                <div class="stat-icon">üéØ</div>
                                <div class="stat-number" id="totalPoints">0</div>
                                <div class="stat-label">points given</div>
                            </div>
                        </div>
                        <div class="recent-activity">
                            <h3>üêõ recent activity</h3>
                            <div id="activityList" class="activity-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Users Window -->
                <div class="window draggable" id="window-users" style="display: none;">
                    <div class="window-header">
                        <span>üê∞ Player Management</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('users')">_</button>
                            <button class="maximize" onclick="maximizeWindow('users')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('users')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="toolbar">
                            <button class="button" onclick="showCreateUser()">+ new player üçÑ</button>
                            <div class="search-container">
                                <input type="text" 
                                       class="text-input search" 
                                       id="searchUsers" 
                                       placeholder="search @handle..."
                                       onkeyup="searchUsers()">
                                <span class="search-icon">üîç</span>
                            </div>
                        </div>
                        <div class="table-wrapper">
                            <table class="data-table" id="usersTable">
                                <thead>
                                    <tr>
                                        <th>@handle</th>
                                        <th>access code</th>
                                        <th>character</th>
                                        <th>status</th>
                                        <th>team</th>
                                        <th>credits</th>
                                        <th>ind pts</th>
                                        <th>team pts</th>
                                        <th>tools</th>
                                        <th>actions</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <tr><td colspan="10" class="loading-cell">loading...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Create User Dialog -->
                <div class="window dialog" id="createUserDialog" style="display: none;">
                    <div class="window-header">
                        <span>üçÑ Create Player</span>
                        <button class="window-close" onclick="hideCreateUser()">√ó</button>
                    </div>
                    <div class="window-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>access code* <span class="label-hint">(unique identifier)</span></label>
                                <input type="text" class="text-input" id="newAccessCode" placeholder="PLAYER001">
                            </div>
                            <div class="form-group">
                                <label>@handle* <span class="label-hint">(instagram)</span></label>
                                <input type="text" class="text-input" id="newHandle" placeholder="@coolguy2000">
                            </div>
                            <div class="form-group">
                                <label>email <span class="label-hint">(optional)</span></label>
                                <input type="email" class="text-input" id="newEmail" placeholder="player@email.com">
                            </div>
                            <div class="form-group">
                                <label>character <span class="label-hint">(can assign later)</span></label>
                                <select class="select-input" id="newCharacter">
                                    <option value="">-- pick later --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>team assignment</label>
                                <select class="select-input" id="newTeam">
                                    <option value="">unassigned</option>
                                    <option value="cable">team cable üì∫</option>
                                    <option value="milk">team milk ü•õ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>initial credits</label>
                                <input type="number" class="text-input" id="newPayment" value="0" min="0">
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <label>welcome note <span class="label-hint">(player will see this)</span> üíå</label>
                            <textarea class="text-input" id="newUserNote" placeholder="hey you made it..."></textarea>
                        </div>
                        <div class="dialog-buttons">
                            <button class="button primary" onclick="createUser()">create player üê≥</button>
                            <button class="button" onclick="hideCreateUser()">cancel</button>
                        </div>
                        <div id="createUserMessage" class="form-message"></div>
                    </div>
                </div>

                <!-- Edit User Dialog -->
                <div class="window dialog" id="editUserDialog" style="display: none;">
                    <div class="window-header">
                        <span>üìü Edit: <span id="editUserHandle"></span></span>
                        <button class="window-close" onclick="hideEditUser()">√ó</button>
                    </div>
                    <div class="window-body">
                        <div class="tabs">
                            <button class="tab active" onclick="switchEditTab('info')">info</button>
                            <button class="tab" onclick="switchEditTab('credits')">credits</button>
                            <button class="tab" onclick="switchEditTab('tools')">tools</button>
                            <button class="tab" onclick="switchEditTab('points')">points</button>
                            <button class="tab" onclick="switchEditTab('message')">message</button>
                        </div>
                        
                        <div class="tab-content" id="edit-info-tab">
                            <input type="hidden" id="editUserId">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>@handle</label>
                                    <input type="text" class="text-input" id="editHandle">
                                </div>
                                <div class="form-group">
                                    <label>status</label>
                                    <select class="select-input" id="editStatus">
                                        <option value="active">active ‚úÖ</option>
                                        <option value="blocked">blocked üö´</option>
                                        <option value="dead">eliminated üíÄ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>team</label>
                                    <select class="select-input" id="editTeam">
                                        <option value="">unassigned</option>
                                        <option value="cable">team cable üì∫</option>
                                        <option value="milk">team milk ü•õ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>character</label>
                                    <select class="select-input" id="editCharacter">
                                        <option value="">-- none --</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="edit-credits-tab" style="display: none;">
                            <div class="credit-display" id="userCreditDisplay">
                                <span class="credit-label">current balance:</span>
                                <span class="credit-amount">0</span>
                            </div>
                            <div class="transaction-history" id="userTransactionHistory"></div>
                            <div class="quick-actions">
                                <button class="button small" onclick="quickAddCredits(25, false)">+25</button>
                                <button class="button small" onclick="quickAddCredits(50, false)">+50</button>
                                <button class="button small" onclick="quickAddCredits(100, false)">+100</button>
                                <button class="button small special" onclick="quickAddCredits(25, true)">üéÅ gift 25</button>
                                <button class="button small warning" onclick="clearPending()">clear debt</button>
                            </div>
                            <div class="form-grid" style="margin-top: 20px;">
                                <div class="form-group">
                                    <label>add custom amount</label>
                                    <input type="number" class="text-input" id="customCreditAmount" placeholder="0">
                                </div>
                                <div class="form-group">
                                    <label>transaction note</label>
                                    <input type="text" class="text-input" id="customCreditNote" placeholder="payment received">
                                </div>
                            </div>
                            <button class="button primary" onclick="addCustomCredits()">add credits üíä</button>
                        </div>
                        
                        <div class="tab-content" id="edit-tools-tab" style="display: none;">
                            <div class="user-tools" id="userToolsList"></div>
                            <h4 style="margin-top: 20px;">üî™ give tools <span class="label-hint">(costs credits)</span></h4>
                            <div class="available-tools" id="availableToolsList"></div>
                        </div>
                        
                        <div class="tab-content" id="edit-points-tab" style="display: none;">
                            <div class="points-display">
                                <div class="point-stat">
                                    <span class="label">individual points:</span>
                                    <span class="value" id="userIndPoints">0</span>
                                </div>
                                <div class="point-stat">
                                    <span class="label">team points:</span>
                                    <span class="value" id="userTeamPoints">0</span>
                                </div>
                            </div>
                            <div class="points-history" id="userPointsHistory"></div>
                            <div class="form-grid" style="margin-top: 20px;">
                                <div class="form-group">
                                    <label>points to add</label>
                                    <input type="number" class="text-input" id="pointsAmount" placeholder="10">
                                </div>
                                <div class="form-group">
                                    <label>point type</label>
                                    <select class="select-input" id="pointType">
                                        <option value="standard">standard (1x)</option>
                                        <option value="double">double üîã (2x)</option>
                                        <option value="super">super üçì (5x)</option>
                                        <option value="bonus">bonus üé± (3x)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>apply to</label>
                                    <select class="select-input" id="pointTarget">
                                        <option value="individual">individual only</option>
                                        <option value="team">team only</option>
                                        <option value="both">both (team event)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>reason</label>
                                    <input type="text" class="text-input" id="pointReason" placeholder="won challenge">
                                </div>
                            </div>
                            <button class="button primary" onclick="addPoints()">award points üé±</button>
                        </div>
                        
                        <div class="tab-content" id="edit-message-tab" style="display: none;">
                            <div class="previous-notes" id="previousNotes"></div>
                            <textarea class="text-input message-input" id="editUserMessage" placeholder="send them a note... üíå"></textarea>
                            <div class="quick-messages">
                                <button class="button small" onclick="quickMsg('ur doing great')">doing great</button>
                                <button class="button small" onclick="quickMsg('something big is coming...')">big news</button>
                                <button class="button small" onclick="quickMsg('check ur tools üî™')">check tools</button>
                                <button class="button small" onclick="quickMsg('stay tuned for the next challenge')">stay tuned</button>
                            </div>
                        </div>
                        
                        <div class="dialog-buttons">
                            <button class="button primary" onclick="saveUserEdit()">save changes üíΩ</button>
                            <button class="button" onclick="hideEditUser()">cancel</button>
                        </div>
                        <div id="editUserMessage" class="form-message"></div>
                    </div>
                </div>

                <!-- Characters Window -->
                <div class="window draggable" id="window-characters" style="display: none;">
                    <div class="window-header">
                        <span>üíø Characters</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('characters')">_</button>
                            <button class="maximize" onclick="maximizeWindow('characters')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('characters')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="character-stats">
                            <div class="stat-badge available">
                                <span class="stat-value" id="availableChars">0</span>
                                <span class="stat-name">available</span>
                            </div>
                            <div class="stat-badge taken">
                                <span class="stat-value" id="takenChars">0</span>
                                <span class="stat-name">taken</span>
                            </div>
                        </div>
                        <div class="characters-grid" id="charactersGrid"></div>
                    </div>
                </div>

                <!-- Tools Window -->
                <div class="window draggable" id="window-tools" style="display: none;">
                    <div class="window-header">
                        <span>üî™ Tools Management</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('tools')">_</button>
                            <button class="maximize" onclick="maximizeWindow('tools')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('tools')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="toolbar">
                            <button class="button" onclick="showCreateTool()">+ new tool ü™§</button>
                            <span class="toolbar-info">manage available tools & prices</span>
                        </div>
                        <div class="tools-list" id="toolsList"></div>
                    </div>
                </div>

                <!-- Create/Edit Tool Dialog -->
                <div class="window dialog" id="toolDialog" style="display: none;">
                    <div class="window-header">
                        <span id="toolDialogTitle">ü™§ Create Tool</span>
                        <button class="window-close" onclick="hideToolDialog()">√ó</button>
                    </div>
                    <div class="window-body">
                        <input type="hidden" id="editingToolId">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>tool name*</label>
                                <input type="text" class="text-input" id="toolName" placeholder="SUPER HAMMER">
                            </div>
                            <div class="form-group">
                                <label>price* <span class="label-hint">(credits)</span></label>
                                <input type="number" class="text-input" id="toolPrice" placeholder="100" min="1">
                            </div>
                            <div class="form-group">
                                <label>icon filename</label>
                                <input type="text" class="text-input" id="toolIcon" placeholder="hammer.png">
                            </div>
                            <div class="form-group">
                                <label>visibility</label>
                                <select class="select-input" id="toolVisible">
                                    <option value="true">visible in store ‚úÖ</option>
                                    <option value="false">hidden üö´</option>
                                </select>
                            </div>
                            <div class="form-group full-width">
                                <label>description</label>
                                <textarea class="text-input" id="toolDescription" placeholder="what does this tool do?"></textarea>
                            </div>
                        </div>
                        <div class="dialog-buttons">
                            <button class="button primary" onclick="saveTool()">save tool üîß</button>
                            <button class="button" onclick="hideToolDialog()">cancel</button>
                        </div>
                        <div id="toolMessage" class="form-message"></div>
                    </div>
                </div>

                <!-- Points Window -->
                <div class="window draggable" id="window-points" style="display: none;">
                    <div class="window-header">
                        <span>üé± Points Overview</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('points')">_</button>
                            <button class="maximize" onclick="maximizeWindow('points')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('points')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="points-types">
                            <h3>Point Multipliers</h3>
                            <div class="point-type-list">
                                <div class="point-type standard">
                                    <span class="type-icon">‚≠ê</span>
                                    <span class="type-name">standard</span>
                                    <span class="type-multiplier">1x</span>
                                </div>
                                <div class="point-type double">
                                    <span class="type-icon">üîã</span>
                                    <span class="type-name">double</span>
                                    <span class="type-multiplier">2x</span>
                                </div>
                                <div class="point-type super">
                                    <span class="type-icon">üçì</span>
                                    <span class="type-name">super</span>
                                    <span class="type-multiplier">5x</span>
                                </div>
                                <div class="point-type bonus">
                                    <span class="type-icon">üé±</span>
                                    <span class="type-name">bonus</span>
                                    <span class="type-multiplier">3x</span>
                                </div>
                            </div>
                        </div>
                        <div class="points-leaderboard" id="pointsLeaderboard"></div>
                        <div class="points-log">
                            <h3>Recent Points Activity</h3>
                            <div id="pointsActivityLog" class="activity-log"></div>
                        </div>
                    </div>
                </div>

                <!-- Teams Window -->
                <div class="window draggable" id="window-teams" style="display: none;">
                    <div class="window-header">
                        <span>ü¶ì Teams</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('teams')">_</button>
                            <button class="maximize" onclick="maximizeWindow('teams')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('teams')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="teams-standings" id="teamsStandings"></div>
                    </div>
                </div>

                <!-- Credits Overview Window -->
                <div class="window draggable" id="window-money" style="display: none;">
                    <div class="window-header">
                        <span>üíä Credits Overview</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('money')">_</button>
                            <button class="maximize" onclick="maximizeWindow('money')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('money')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="money-stats">
                            <div class="stat-card collected">
                                <div class="stat-icon">üí∞</div>
                                <div class="stat-number" id="totalCollected">0</div>
                                <div class="stat-label">total collected</div>
                            </div>
                            <div class="stat-card pending">
                                <div class="stat-icon">‚è≥</div>
                                <div class="stat-number" id="totalPendingAmount">0</div>
                                <div class="stat-label">pending</div>
                            </div>
                            <div class="stat-card gifted">
                                <div class="stat-icon">üéÅ</div>
                                <div class="stat-number" id="totalGifted">0</div>
                                <div class="stat-label">gifted</div>
                            </div>
                        </div>
                        <div class="pending-payments">
                            <h3>üßß Players with Pending Payments</h3>
                            <div id="pendingPaymentsList" class="payments-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Pending Requests Window -->
                <div class="window draggable" id="window-pending" style="display: none;">
                    <div class="window-header">
                        <span>‚ö†Ô∏è Pending Requests</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('pending')">_</button>
                            <button class="maximize" onclick="maximizeWindow('pending')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('pending')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="pending-stats">
                            <span class="pending-count" id="pendingCount">0</span>
                            <span>requests waiting for approval</span>
                        </div>
                        <div class="pending-list" id="pendingList">
                            <div class="empty-state">
                                <span class="empty-icon">‚ú®</span>
                                <p>no pending requests</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Minimized Windows Bar -->
            <div class="minimized-bar" id="minimizedBar"></div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div class="toast" id="toast"></div>

    <!-- Firebase & Admin Scripts -->
    <script type="module" src="admin.js"></script>
</body>
</html>