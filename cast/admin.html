<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INTERNET OLYMPICS 2 ‚Ä¢ admin board</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <!-- Login Window -->
    <div class="window login-window" id="loginWindow">
        <div class="window-header">
            <span>üîê System Login</span>
            <button class="window-close" disabled>√ó</button>
        </div>
        <div class="window-body">
            <div class="login-icon">üéÆ</div>
            <div class="login-message">hey. it's the admin panel. you know what to do.</div>
            <input type="password" 
                   id="adminPassword" 
                   class="text-input" 
                   placeholder="password goes here"
                   autocomplete="off">
            <button class="button primary" onclick="adminLogin()">let me in ‚Üí</button>
            <div class="error-message" id="loginError">nope. try again.</div>
        </div>
    </div>

    <!-- Main Admin Panel -->
    <div class="admin-container" id="adminPanel" style="display: none;">
        <!-- Desktop -->
        <div class="desktop">
            <!-- Header Bar -->
            <div class="taskbar">
                <div class="start-button">
                    <span>üéÆ INTERNET OLYMPICS 2</span>
                </div>
                <div class="taskbar-clock" id="clock"></div>
                <button class="logout-button" onclick="adminLogout()">log out ‚Üí</button>
            </div>

            <!-- Desktop Icons -->
            <div class="desktop-icons">
                <div class="desktop-icon" onclick="openWindow('dashboard')">
                    <div class="icon">üìä</div>
                    <div class="label">Dashboard</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('users')">
                    <div class="icon">üê∞</div>
                    <div class="label">Players</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('characters')">
                    <div class="icon">üíø</div>
                    <div class="label">Characters</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('tools')">
                    <div class="icon">üî™</div>
                    <div class="label">Tools</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('points')">
                    <div class="icon">üé±</div>
                    <div class="label">Points</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('money')">
                    <div class="icon">üíä</div>
                    <div class="label">Credits</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('teams')">
                    <div class="icon">ü¶ì</div>
                    <div class="label">Teams</div>
                </div>
                <div class="desktop-icon" onclick="openWindow('pending')">
                    <div class="icon">‚ö†Ô∏è</div>
                    <div class="label">Pending</div>
                </div>
            </div>

            <!-- Windows Container -->
            <div class="windows-container" id="windowsContainer">
                <!-- Dashboard Window -->
                <div class="window draggable" id="window-dashboard" style="display: none;">
                    <div class="window-header">
                        <span>üìä Dashboard</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('dashboard')">_</button>
                            <button class="maximize" onclick="maximizeWindow('dashboard')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('dashboard')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="stats-grid" id="statsGrid">
                            <div class="stat-card">
                                <div class="stat-number" id="totalUsers">0</div>
                                <div class="stat-label">players</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="activeUsers">0</div>
                                <div class="stat-label">still alive</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalRevenue">0</div>
                                <div class="stat-label">collected</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalCredit">0</div>
                                <div class="stat-label">credits available</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalPending">0</div>
                                <div class="stat-label">pending</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalPoints">0</div>
                                <div class="stat-label">points given</div>
                            </div>
                        </div>
                        <div class="recent-activity" id="recentActivity">
                            <h3>üêõ recent activity</h3>
                            <div id="activityList"></div>
                        </div>
                    </div>
                </div>

                <!-- Users Window -->
                <div class="window draggable" id="window-users" style="display: none;">
                    <div class="window-header">
                        <span>üê∞ Player Management</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('users')">_</button>
                            <button class="maximize" onclick="maximizeWindow('users')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('users')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="toolbar">
                            <button class="button" onclick="showCreateUser()">+ new player üçÑ</button>
                            <input type="text" 
                                   class="text-input search" 
                                   id="searchUsers" 
                                   placeholder="search @handle..."
                                   onkeyup="searchUsers()">
                        </div>
                        <div class="users-table-container">
                            <table class="data-table" id="usersTable">
                                <thead>
                                    <tr>
                                        <th>@handle</th>
                                        <th>access code</th>
                                        <th>character</th>
                                        <th>status</th>
                                        <th>team</th>
                                        <th>credits</th>
                                        <th>ind pts</th>
                                        <th>team pts</th>
                                        <th>tools</th>
                                        <th>actions</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <tr><td colspan="10">loading...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Create User Dialog -->
                <div class="window dialog" id="createUserDialog" style="display: none;">
                    <div class="window-header">
                        <span>üçÑ Create Player</span>
                        <button class="window-close" onclick="hideCreateUser()">√ó</button>
                    </div>
                    <div class="window-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>access code* (unique)</label>
                                <input type="text" class="text-input" id="newAccessCode" placeholder="PLAYER001">
                            </div>
                            <div class="form-group">
                                <label>@handle* (instagram)</label>
                                <input type="text" class="text-input" id="newHandle" placeholder="@coolguy2000">
                            </div>
                            <div class="form-group">
                                <label>email (optional)</label>
                                <input type="email" class="text-input" id="newEmail" placeholder="optional">
                            </div>
                            <div class="form-group">
                                <label>character (optional)</label>
                                <select class="select-input" id="newCharacter">
                                    <option value="">-- pick later --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>team</label>
                                <select class="select-input" id="newTeam">
                                    <option value="">unassigned</option>
                                    <option value="cable">team cable üì∫</option>
                                    <option value="milk">team milk ü•õ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>initial credits</label>
                                <input type="number" class="text-input" id="newPayment" value="0" min="0">
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <label>welcome note (they'll see this) üíå</label>
                            <textarea class="text-input" id="newUserNote" placeholder="hey you made it..."></textarea>
                        </div>
                        <div class="dialog-buttons">
                            <button class="button primary" onclick="createUser()">create player üê≥</button>
                            <button class="button" onclick="hideCreateUser()">cancel</button>
                        </div>
                        <div id="createUserMessage"></div>
                    </div>
                </div>

                <!-- Edit User Dialog -->
                <div class="window dialog" id="editUserDialog" style="display: none;">
                    <div class="window-header">
                        <span>üìü Edit: <span id="editUserHandle"></span></span>
                        <button class="window-close" onclick="hideEditUser()">√ó</button>
                    </div>
                    <div class="window-body">
                        <div class="tabs">
                            <button class="tab active" onclick="switchEditTab('info')">info</button>
                            <button class="tab" onclick="switchEditTab('credits')">credits</button>
                            <button class="tab" onclick="switchEditTab('tools')">tools</button>
                            <button class="tab" onclick="switchEditTab('points')">points</button>
                            <button class="tab" onclick="switchEditTab('message')">message</button>
                        </div>
                        
                        <div class="tab-content" id="edit-info-tab">
                            <input type="hidden" id="editUserId">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>@handle</label>
                                    <input type="text" class="text-input" id="editHandle">
                                </div>
                                <div class="form-group">
                                    <label>status</label>
                                    <select class="select-input" id="editStatus">
                                        <option value="active">active</option>
                                        <option value="blocked">blocked üö≠</option>
                                        <option value="dead">dead üí£</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>team</label>
                                    <select class="select-input" id="editTeam">
                                        <option value="">unassigned</option>
                                        <option value="cable">team cable üì∫</option>
                                        <option value="milk">team milk ü•õ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>character</label>
                                    <select class="select-input" id="editCharacter">
                                        <option value="">-- none --</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="edit-credits-tab" style="display: none;">
                            <div class="credit-display" id="userCreditDisplay">
                                current credits: 0
                            </div>
                            <div class="transaction-history" id="userTransactionHistory"></div>
                            <div class="quick-actions">
                                <button class="button small" onclick="quickAddCredits(25, false)">+25 credits</button>
                                <button class="button small" onclick="quickAddCredits(50, false)">+50 credits</button>
                                <button class="button small" onclick="quickAddCredits(100, false)">+100 credits</button>
                                <button class="button small special" onclick="quickAddCredits(25, true)">üéÅ gift 25</button>
                                <button class="button small warning" onclick="clearPending()">clear pending</button>
                            </div>
                            <div class="form-grid" style="margin-top: 15px;">
                                <div class="form-group">
                                    <label>add custom credits</label>
                                    <input type="number" class="text-input" id="customCreditAmount" placeholder="amount">
                                </div>
                                <div class="form-group">
                                    <label>note</label>
                                    <input type="text" class="text-input" id="customCreditNote" placeholder="venmo received">
                                </div>
                            </div>
                            <button class="button" onclick="addCustomCredits()">add credits üíä</button>
                        </div>
                        
                        <div class="tab-content" id="edit-tools-tab" style="display: none;">
                            <div class="user-tools" id="userToolsList"></div>
                            <h4 style="margin-top: 20px;">üî™ give tools (costs credits)</h4>
                            <div class="available-tools" id="availableToolsList"></div>
                        </div>
                        
                        <div class="tab-content" id="edit-points-tab" style="display: none;">
                            <div class="points-display">
                                <div class="point-stat">
                                    <span class="label">individual points:</span>
                                    <span class="value" id="userIndPoints">0</span>
                                </div>
                                <div class="point-stat">
                                    <span class="label">team points:</span>
                                    <span class="value" id="userTeamPoints">0</span>
                                </div>
                            </div>
                            <div class="points-history" id="userPointsHistory"></div>
                            <div class="form-grid" style="margin-top: 15px;">
                                <div class="form-group">
                                    <label>points to add</label>
                                    <input type="number" class="text-input" id="pointsAmount" placeholder="10">
                                </div>
                                <div class="form-group">
                                    <label>point type</label>
                                    <select class="select-input" id="pointType">
                                        <option value="standard">standard</option>
                                        <option value="double">double points üîã</option>
                                        <option value="super">super points üçì</option>
                                        <option value="bonus">bonus points üé±</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>apply to</label>
                                    <select class="select-input" id="pointTarget">
                                        <option value="individual">individual only</option>
                                        <option value="team">team only</option>
                                        <option value="both">both (team event)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>reason</label>
                                    <input type="text" class="text-input" id="pointReason" placeholder="won challenge">
                                </div>
                            </div>
                            <button class="button primary" onclick="addPoints()">add points üé±</button>
                        </div>
                        
                        <div class="tab-content" id="edit-message-tab" style="display: none;">
                            <div class="previous-notes" id="previousNotes"></div>
                            <textarea class="text-input" id="editUserMessage" placeholder="send them a note... üíå"></textarea>
                            <div class="quick-messages">
                                <button class="button small" onclick="quickMsg('ur doing great')">ur doing great</button>
                                <button class="button small" onclick="quickMsg('something big is coming...')">something big...</button>
                                <button class="button small" onclick="quickMsg('check ur tools üî™')">check tools</button>
                            </div>
                        </div>
                        
                        <div class="dialog-buttons">
                            <button class="button primary" onclick="saveUserEdit()">save changes üíΩ</button>
                            <button class="button" onclick="hideEditUser()">cancel</button>
                        </div>
                        <div id="editUserMessage"></div>
                    </div>
                </div>

                <!-- Characters Window -->
                <div class="window draggable" id="window-characters" style="display: none;">
                    <div class="window-header">
                        <span>üíø Characters</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('characters')">_</button>
                            <button class="maximize" onclick="maximizeWindow('characters')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('characters')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="character-stats">
                            <span class="stat">available: <strong id="availableChars">0</strong></span>
                            <span class="stat">taken: <strong id="takenChars">0</strong></span>
                        </div>
                        <div class="characters-grid" id="charactersGrid"></div>
                    </div>
                </div>

                <!-- Tools Window -->
                <div class="window draggable" id="window-tools" style="display: none;">
                    <div class="window-header">
                        <span>üî™ Tools Management</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('tools')">_</button>
                            <button class="maximize" onclick="maximizeWindow('tools')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('tools')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="toolbar">
                            <button class="button" onclick="showCreateTool()">+ new tool ü™§</button>
                        </div>
                        <div class="tools-list" id="toolsList"></div>
                    </div>
                </div>

                <!-- Create/Edit Tool Dialog -->
                <div class="window dialog" id="toolDialog" style="display: none;">
                    <div class="window-header">
                        <span id="toolDialogTitle">ü™§ Create Tool</span>
                        <button class="window-close" onclick="hideToolDialog()">√ó</button>
                    </div>
                    <div class="window-body">
                        <input type="hidden" id="editingToolId">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>name*</label>
                                <input type="text" class="text-input" id="toolName" placeholder="SUPER HAMMER">
                            </div>
                            <div class="form-group">
                                <label>price* (credits)</label>
                                <input type="number" class="text-input" id="toolPrice" placeholder="100" min="1">
                            </div>
                            <div class="form-group">
                                <label>icon filename</label>
                                <input type="text" class="text-input" id="toolIcon" placeholder="hammer.png">
                            </div>
                            <div class="form-group">
                                <label>visible?</label>
                                <select class="select-input" id="toolVisible">
                                    <option value="true">yes - show in store</option>
                                    <option value="false">no - hidden</option>
                                </select>
                            </div>
                            <div class="form-group full-width">
                                <label>description</label>
                                <textarea class="text-input" id="toolDescription" placeholder="what does it do?"></textarea>
                            </div>
                        </div>
                        <div class="dialog-buttons">
                            <button class="button primary" onclick="saveTool()">save tool üîß</button>
                            <button class="button" onclick="hideToolDialog()">cancel</button>
                        </div>
                        <div id="toolMessage"></div>
                    </div>
                </div>

                <!-- Points Window -->
                <div class="window draggable" id="window-points" style="display: none;">
                    <div class="window-header">
                        <span>üé± Points Overview</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('points')">_</button>
                            <button class="maximize" onclick="maximizeWindow('points')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('points')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="points-types">
                            <h3>point types configured:</h3>
                            <div class="point-type-list">
                                <div class="point-type">
                                    <span class="type-name">standard</span>
                                    <span class="type-multiplier">1x</span>
                                </div>
                                <div class="point-type">
                                    <span class="type-name">double üîã</span>
                                    <span class="type-multiplier">2x</span>
                                </div>
                                <div class="point-type">
                                    <span class="type-name">super üçì</span>
                                    <span class="type-multiplier">5x</span>
                                </div>
                                <div class="point-type">
                                    <span class="type-name">bonus üé±</span>
                                    <span class="type-multiplier">3x</span>
                                </div>
                            </div>
                        </div>
                        <div class="points-leaderboard" id="pointsLeaderboard"></div>
                        <div class="points-log">
                            <h3>recent points activity:</h3>
                            <div id="pointsActivityLog"></div>
                        </div>
                    </div>
                </div>

                <!-- Teams Window -->
                <div class="window draggable" id="window-teams" style="display: none;">
                    <div class="window-header">
                        <span>ü¶ì Teams</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('teams')">_</button>
                            <button class="maximize" onclick="maximizeWindow('teams')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('teams')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="teams-standings" id="teamsStandings"></div>
                    </div>
                </div>

                <!-- Credits Overview Window -->
                <div class="window draggable" id="window-money" style="display: none;">
                    <div class="window-header">
                        <span>üíä Credits Overview</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('money')">_</button>
                            <button class="maximize" onclick="maximizeWindow('money')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('money')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="money-stats">
                            <div class="stat-card">
                                <div class="stat-number" id="totalCollected">0</div>
                                <div class="stat-label">collected</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalPendingAmount">0</div>
                                <div class="stat-label">pending</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalGifted">0</div>
                                <div class="stat-label">gifted</div>
                            </div>
                        </div>
                        <div class="pending-payments">
                            <h3>üßß players who need to send funds:</h3>
                            <div id="pendingPaymentsList"></div>
                        </div>
                    </div>
                </div>

                <!-- Pending Requests Window -->
                <div class="window draggable" id="window-pending" style="display: none;">
                    <div class="window-header">
                        <span>‚ö†Ô∏è Pending Requests</span>
                        <div class="window-controls">
                            <button class="minimize" onclick="minimizeWindow('pending')">_</button>
                            <button class="maximize" onclick="maximizeWindow('pending')">‚ñ°</button>
                            <button class="window-close" onclick="closeWindow('pending')">√ó</button>
                        </div>
                    </div>
                    <div class="window-body">
                        <div class="pending-stats">
                            <span id="pendingCount">0</span> requests waiting for approval
                        </div>
                        <div class="pending-list" id="pendingList">
                            <p style="text-align: center; color: #666;">no pending requests</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Minimized Windows Bar -->
            <div class="minimized-bar" id="minimizedBar"></div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div class="toast" id="toast"></div>

    <!-- Firebase -->
    <script type="module" src="admin.js"></script>
</body>
</html>